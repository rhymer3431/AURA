{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mango\\\\project\\\\AURA\\\\webui\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport CytoscapeComponent from \"react-cytoscapejs\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OFFER_URL = \"http://localhost:7000/offer\";\nconst layout = {\n  name: \"cose\",\n  animate: true\n};\nconst style = [{\n  selector: \"node\",\n  style: {\n    \"background-color\": \"#39ff14\",\n    \"border-color\": \"#0affff\",\n    \"border-width\": 2,\n    label: \"data(label)\",\n    color: \"#e0f7ff\",\n    \"font-size\": 12,\n    \"text-outline-color\": \"#0f0f0f\",\n    \"text-outline-width\": 2\n  }\n}, {\n  selector: \"edge\",\n  style: {\n    width: 2,\n    \"line-color\": \"#3b7bff\",\n    \"target-arrow-color\": \"#3b7bff\",\n    \"target-arrow-shape\": \"triangle\",\n    label: \"data(label)\",\n    color: \"#9dc4ff\",\n    \"font-size\": 11,\n    \"text-background-opacity\": 0.6,\n    \"text-background-color\": \"#0f0f0f\",\n    \"curve-style\": \"bezier\"\n  }\n}];\nfunction toElements(graph) {\n  const nodes = (graph.nodes || []).map(n => {\n    var _n$label;\n    return {\n      data: {\n        id: String(n.id),\n        label: (_n$label = n.label) !== null && _n$label !== void 0 ? _n$label : n.id\n      }\n    };\n  });\n  const edges = (graph.edges || []).map((e, idx) => {\n    var _e$label;\n    return {\n      data: {\n        id: `e-${idx}-${e.source}-${e.target}`,\n        source: String(e.source),\n        target: String(e.target),\n        label: (_e$label = e.label) !== null && _e$label !== void 0 ? _e$label : \"\"\n      }\n    };\n  });\n  return [...nodes, ...edges];\n}\nfunction waitForIceGathering(pc) {\n  return new Promise(resolve => {\n    if (pc.iceGatheringState === \"complete\") {\n      resolve();\n    } else {\n      const checkState = () => {\n        if (pc.iceGatheringState === \"complete\") {\n          pc.removeEventListener(\"icegatheringstatechange\", checkState);\n          resolve();\n        }\n      };\n      pc.addEventListener(\"icegatheringstatechange\", checkState);\n    }\n  });\n}\nfunction App() {\n  _s();\n  const cyRef = useRef(null);\n  const videoRef = useRef(null);\n  const pcRef = useRef(null);\n  const [elements, setElements] = useState([]);\n  useEffect(() => {\n    let cancelled = false;\n    async function startWebRTC() {\n      const pc = new RTCPeerConnection({\n        iceServers: []\n      });\n      pcRef.current = pc;\n      const graphChannel = pc.createDataChannel(\"graph\");\n      graphChannel.onmessage = evt => {\n        try {\n          const graph = JSON.parse(evt.data);\n          const newElements = toElements(graph);\n          setElements(newElements);\n          if (cyRef.current) {\n            cyRef.current.json({\n              elements: newElements\n            });\n            cyRef.current.layout(layout).run();\n          }\n        } catch (err) {\n          console.error(\"Failed to parse graph\", err);\n        }\n      };\n      pc.ontrack = event => {\n        const [stream] = event.streams;\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      };\n      await pc.setLocalDescription(await pc.createOffer({\n        offerToReceiveVideo: true\n      }));\n      await waitForIceGathering(pc);\n      if (cancelled) return;\n      const offer = pc.localDescription;\n      const res = await fetch(OFFER_URL, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          sdp: offer.sdp,\n          type: offer.type\n        })\n      });\n      const answer = await res.json();\n      await pc.setRemoteDescription(answer);\n    }\n    startWebRTC();\n    return () => {\n      cancelled = true;\n      if (pcRef.current) {\n        pcRef.current.close();\n      }\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: \"#0f0f0f\",\n      width: \"100vw\",\n      height: \"100vh\",\n      margin: 0,\n      padding: 0,\n      overflow: \"hidden\",\n      display: \"flex\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        borderRight: \"1px solid #1f1f1f\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        style: {\n          width: \"100%\",\n          height: \"100%\",\n          objectFit: \"cover\",\n          background: \"#000\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(CytoscapeComponent, {\n        cy: cy => {\n          cyRef.current = cy;\n        },\n        elements: elements,\n        layout: layout,\n        stylesheet: style,\n        style: {\n          width: \"100%\",\n          height: \"100%\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"xbjqhlnBKDqi8s5gKXDtndAxz8o=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useEffect","useRef","useState","CytoscapeComponent","jsxDEV","_jsxDEV","OFFER_URL","layout","name","animate","style","selector","label","color","width","toElements","graph","nodes","map","n","_n$label","data","id","String","edges","e","idx","_e$label","source","target","waitForIceGathering","pc","Promise","resolve","iceGatheringState","checkState","removeEventListener","addEventListener","App","_s","cyRef","videoRef","pcRef","elements","setElements","cancelled","startWebRTC","RTCPeerConnection","iceServers","current","graphChannel","createDataChannel","onmessage","evt","JSON","parse","newElements","json","run","err","console","error","ontrack","event","stream","streams","srcObject","setLocalDescription","createOffer","offerToReceiveVideo","offer","localDescription","res","fetch","method","headers","body","stringify","sdp","type","answer","setRemoteDescription","close","background","height","margin","padding","overflow","display","children","flex","borderRight","ref","autoPlay","playsInline","muted","objectFit","fileName","_jsxFileName","lineNumber","columnNumber","cy","stylesheet","_c","$RefreshReg$"],"sources":["C:/Users/mango/project/AURA/webui/src/App.js"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport CytoscapeComponent from \"react-cytoscapejs\";\n\nconst OFFER_URL = \"http://localhost:7000/offer\";\n\nconst layout = { name: \"cose\", animate: true };\nconst style = [\n  {\n    selector: \"node\",\n    style: {\n      \"background-color\": \"#39ff14\",\n      \"border-color\": \"#0affff\",\n      \"border-width\": 2,\n      label: \"data(label)\",\n      color: \"#e0f7ff\",\n      \"font-size\": 12,\n      \"text-outline-color\": \"#0f0f0f\",\n      \"text-outline-width\": 2,\n    },\n  },\n  {\n    selector: \"edge\",\n    style: {\n      width: 2,\n      \"line-color\": \"#3b7bff\",\n      \"target-arrow-color\": \"#3b7bff\",\n      \"target-arrow-shape\": \"triangle\",\n      label: \"data(label)\",\n      color: \"#9dc4ff\",\n      \"font-size\": 11,\n      \"text-background-opacity\": 0.6,\n      \"text-background-color\": \"#0f0f0f\",\n      \"curve-style\": \"bezier\",\n    },\n  },\n];\n\nfunction toElements(graph) {\n  const nodes = (graph.nodes || []).map((n) => ({\n    data: { id: String(n.id), label: n.label ?? n.id },\n  }));\n  const edges = (graph.edges || []).map((e, idx) => ({\n    data: {\n      id: `e-${idx}-${e.source}-${e.target}`,\n      source: String(e.source),\n      target: String(e.target),\n      label: e.label ?? \"\",\n    },\n  }));\n  return [...nodes, ...edges];\n}\n\nfunction waitForIceGathering(pc) {\n  return new Promise((resolve) => {\n    if (pc.iceGatheringState === \"complete\") {\n      resolve();\n    } else {\n      const checkState = () => {\n        if (pc.iceGatheringState === \"complete\") {\n          pc.removeEventListener(\"icegatheringstatechange\", checkState);\n          resolve();\n        }\n      };\n      pc.addEventListener(\"icegatheringstatechange\", checkState);\n    }\n  });\n}\n\nfunction App() {\n  const cyRef = useRef(null);\n  const videoRef = useRef(null);\n  const pcRef = useRef(null);\n  const [elements, setElements] = useState([]);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    async function startWebRTC() {\n      const pc = new RTCPeerConnection({ iceServers: [] });\n      pcRef.current = pc;\n\n      const graphChannel = pc.createDataChannel(\"graph\");\n      graphChannel.onmessage = (evt) => {\n        try {\n          const graph = JSON.parse(evt.data);\n          const newElements = toElements(graph);\n          setElements(newElements);\n          if (cyRef.current) {\n            cyRef.current.json({ elements: newElements });\n            cyRef.current.layout(layout).run();\n          }\n        } catch (err) {\n          console.error(\"Failed to parse graph\", err);\n        }\n      };\n\n      pc.ontrack = (event) => {\n        const [stream] = event.streams;\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      };\n\n      await pc.setLocalDescription(await pc.createOffer({ offerToReceiveVideo: true }));\n      await waitForIceGathering(pc);\n\n      if (cancelled) return;\n\n      const offer = pc.localDescription;\n      const res = await fetch(OFFER_URL, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ sdp: offer.sdp, type: offer.type }),\n      });\n      const answer = await res.json();\n      await pc.setRemoteDescription(answer);\n    }\n\n    startWebRTC();\n\n    return () => {\n      cancelled = true;\n      if (pcRef.current) {\n        pcRef.current.close();\n      }\n    };\n  }, []);\n\n  return (\n    <div\n      style={{\n        background: \"#0f0f0f\",\n        width: \"100vw\",\n        height: \"100vh\",\n        margin: 0,\n        padding: 0,\n        overflow: \"hidden\",\n        display: \"flex\",\n      }}\n    >\n      <div style={{ flex: 1, borderRight: \"1px solid #1f1f1f\" }}>\n        <video\n          ref={videoRef}\n          autoPlay\n          playsInline\n          muted\n          style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\", background: \"#000\" }}\n        />\n      </div>\n\n      <div style={{ flex: 1 }}>\n        <CytoscapeComponent\n          cy={(cy) => {\n            cyRef.current = cy;\n          }}\n          elements={elements}\n          layout={layout}\n          stylesheet={style}\n          style={{ width: \"100%\", height: \"100%\" }}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}